<!DOCTYPE html>
<!--
 * Copyright © 2018, Oracle and/or its affiliates. All rights reserved.
 *
 * The Universal Permissive License (UPL), Version 1.0
 * https://oss.oracle.com/licenses/upl
 -->
<html lang="en">
    <head>
        <!-- Part number: Ennnnn-01 -->
        <!-- Published date: Month Year -->
        <!-- Template date: 10/18/17 -->
        <meta content="text/html; charset=utf-8" http-equiv="content-type">
        <title>Best Practices for Building and Training Intents</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="robots" content="INDEX, FOLLOW">
        <meta name="description" content="Put the description of the tutorial here.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="css/normalize.min.css">
        <link rel="stylesheet" href="css/font-awesome.min.css">
        <link rel="stylesheet" href="css/obe-lite.css">
        <script src="js/jquery-1.11.0.min.js"></script>
        <script src="js/jquery-ui-1.10.4.custom.js"></script>
        <script src="js/jquery.tocify.jd.js"></script>
        <script src="js/leftnav.js"></script>
    </head>
    <body>
        <header>
            <div class="w1024" style="min-height:55px; display:block;"> <a href="https://docs.oracle.com" class="oracle-logo">
              <img src="./img/oracle_doc_logo.png" alt="Oracle Documentation" style="max-width: none;" height="22" width="236"></a>
            </div>
        </header>
        <!--end header-->

        <div id="content">
<blockquote><h4><a href="../index.html">Back to the Index Page</a></h4></blockquote>

            <h1><img src="./img/obe_tag.png" align="middle" alt="Oracle by Example branding">Best Practices for Buiding and Training Intents</h1>
            <div class="w1024" style="clear:both; position:relative; margin-top:40px;">
                <div class="navbackwide border-right"><!-- --></div>
                <div id="shownav" title="Show Navigation" tabindex="0"><span class="fa fa-list"></span></div>
                <div id="sidebar"><!-- -->
                    <div class="left-nav-tut"><!-- -->
                        <div id="hidenavw" title="Hide Navigation" tabindex="0"><span class="fa fa-close"></span></div>
                        <div  id="navbar" class="left-nav-w"><!-- -->
                            <div id="toc" class="tocify"><!-- --></div>
                        </div>
                    </div>
                </div>
                <div id="bookContainer">
                    <article>
                                            <p class="MsoNormal" style="text-align:justify"><span style="mso-ansi-language:EN-US" lang="EN-US"><b>
                                <font size="+1">Tutorial by Grant Ronald, Oracle</font>
                            </b>
                            <br>
                            March 2019, Oracle Digital Assistant version 19.1.3<br>
                        </span></p>
                        
				

						<hr>

                        <!-- ========================================================================================================================= -->

                         <section>
                            <h2 id="section_1" role="button" style="text-align: left;"><img src="./img/32_begin.png" alt="section 1" height="32" width="32" class="num_circ">Before You Begin</h2>
                             <p>This 45 minute tutorial demonstrates some good practices for training and improving your intents.</p>
                             <h3>Background</h3>
							<p>The purpose of this lab is to become familiar with tips and techniques for training and testing your skills.  
						Specifically, you will add utterances to the skill to train it to understand a simple pizza ordering use case. Then you'll work with a colleague to iteratively test your skill, adding more test data as you go along to fine-tune intent resolution.</p>
						<p>We’ll focus on these intents:</p>
						<ul>
							<li><code>FileComplaint</code> – used when the customer has an issue that needs to be resolved, probably by a live agent.</li>
							<li><code>OpenFranchise</code> –  allows the customer to inquire about opening up a franchise to sell pizzas online.</li>
							<li><code>TrackOrder</code> – used when the customer wants to check the status of an order, cancel and order, or check the progress of an order.</li>
						</ul>
                             <h3>What do you need?</h3>
                             <p><ul><li>Access to an Oracle Digital Assistant instance.</li>
                             <li>Download <a href="files/PizzaStarter_bot1.zip" target="_blank"><code>PizzaStarter_bot1.zip</code></a> which has the basic intents for testing.</li></ul>
                        </section>
                        
                        <section>
                            <h2 id="section_1" role="button" style="text-align: left;"><img src="./img/32_1.png" alt="section 1" height="32" width="32" class="num_circ">Clone the <code>PizzaStarter_bot1</code> skill</h2>
							<p>We'll start with a skill that has been pre-populated with a few intents. Since you won't be the only one using your instance, you'll want to create your own copy of that skill to work with.</p>
                            <ol>
                                <li>Open the main menu by clicking <img src="img/hamburger.png" alt="main menu icon"> and select <b>Development > Skills</b>.</li>
								<li>Within the tile for the <code>PizzaStarter_bot1</code> skill, click <img src="img/options-menu.png" alt="the Options menu icon">, select <b>Clone</b>, and name the clone <code><i>&lt;YourInitials&gt;</i>_PizzaStarter_bot1</code>.
								<p class="note">For example: <code>JS_PizzaStarter_bot1</i></code>.</p></li>
								<li>Locate the tile for your clone of the skill  (using the Search field might help) and click it to open the skill.</li>
                            </ol>
                        </section>
                        <hr>
                        <section>
                            <h2 id="section_2" role="button" style="text-align: left;"><img src="./img/32_2.png" alt="section 2" height="32" width="32" class="num_circ">Turn On Conversation Logging</h2>
                            <p>We'll log the conversations with the skill in order to use those inputs to retrain and test the skill.</p>
                            <ol>
                                <li>In the left navigation of your skill, click <img src="img/left_nav_settings.png" alt="the Settings icon">.</li>
								<li>Select the <b>General</b> tab.</li>
                                <li>Set the Enable Conversation Logging switches for <b>Intent Conversation</b>, <b>Q&A Conversation</b>, and <b>Skill Conversation</b> to ON.</li>
                            </ol>
                        </section>
                        <hr>
                        <section>
                            <h2 id="section_3" role="button" style="text-align: left;"><img src="./img/32_3.png" alt="section 3" height="32" width="32" class="num_circ">Create Utterances and Do a Round of Batch Testing</h2>
							<p>Next we'll prepare some data so we can run reproducible tests to help measure the success of the skill in understanding a conversation with a user.  You can do batch testing by uploading a <code>.csv</code> file that contains test phrases and the intents to which they should resolve.</p>
							<p>As a starting point, let's export the intents of the skill to get a <code>.csv</code> file with the correct format.</p>
                            <ol>
                                <li>Select <img src="img/intents_icon.png" alt="the Intents icon"> and select <b>More > Export intents</b>.<br><br>
								<img src="img/export-intents.png" alt="screenshot showing the selection of the Export intents menu item from the More menu."> 
								<!--<p class="note">You should see the data displayed in two columns.</p>
								<p class="note"><b>Note:</b> If you open the file in Microsoft Excel, the data may initially appear in just one column. You can fix this by selecting the whole column, selecting the <b>Data</b> ribbon, clicking <b>Text to Columns</b> and specifying in the wizard that the content is comma-delimited.<i>PK: still need to test this</i></p>-->
								</li>
								<li>Save the files as <code>batchtest1.csv</code>.</li>
                                <li>In Notepad or a similar text editor, write phrases that you think would be representative utterances for the <code>FileComplaint</code>, <code>OpenFranchise</code>, and <code>TrackOrders</code> intents.
								<p class="note">Write <b>10 utterances</b> for each of those intents.</p></li>
								<li>For each intent, add 7 of the utterances you have just written to the skill by doing the following:
									<ol type="a">
										<li>Selecting the intent.</li>
										<li>Within the Examples area, pasting the utterances.</li>
										<li>Clicking <b>Train</b>, leaving <b>Trainer Ht</b> selected, and clicking <b>Submit</b>.</li>
									</ol></li>
								<li>Add the remaining 3 utterances for each intent to the <code>batchtest1.csv</code> file by:
									<ol type="a">
										<li>Copying the utterances into the first column.</li>
										<li>In the second column of each row, entering the name of the intent that the utterance is supposed to resolve to.</li>
									</ol></li>
								<li>Click <img src="img/tryItOut.png" alt="Test icon">.</li>
								<li>Select <b>Intent</b>.
								<li>Slide the <b>Batch</b> switch to ON.</li>
								<li>Click <b>Load</b>.</li>
								<li>Drag <code>batchtest1.csv</code> into the Load Batch dialog and click <b>Test</b>.</li>
                            </ol>
							<p>Take a look at the results and take note of anything that you find surprising.</p>
                            <p><b>What you just did.</b>  When developing a new skill it is likley that you don't have any existing training utterances so you have to synthesize utterances to train the model.  Here you have undertaken a good practice by using some utterances to train the model and some which have been used for batch testing.</p>  <p>By using some of the phrases for batch testing you are always able to test your intents and compare to whether these phrases are resolving to the intents you expect - ultimately you want to show that your model is resolving more and more phrase correctly over time.  This is incredibly important as you go through your skill development where you will add more training utterances and/or change the model as more people use it.</p>
                        </section>
                        <hr>
                        <section>
                            <h2 id="section_4" role="button" style="text-align: left;"><img src="./img/32_4.png" alt="section 4" height="32" width="32" class="num_circ">Iteratively Test Your Intents</h2>
							<p>At this point, you have done one round of testing. To make sure that you have a robust training corpus of utterances, you'll want to do several more rounds and make any necessary adjustments to your utterances as you go along.  This is iterative approach is a good practice for your skill development.</p>
							<p>As part of this, you'll want to get other people involved in training your skill since phrases you think of to match an intent will probably vary from what other people come up with.</p>

                            <ol>
                                <li>With the help of your instructor, find a test partner.</li>
                                <li>Have your partner enter phrases of their own in the tester for <i>your skill</i> (3 phrases for each of the 3 intents). You'll do the same for your partner's skill. To use the tester:
									<ol type="a">
										<li>Click <img src="img/testerIcon.png" alt="tester">.</li>										
										<li>Type a phrase in the Message field and press Enter.</li>
									</ol>
								</li>
								<li>Once your partner has finished entering phrases, open the skill's conversation logs by:
									<ol type="a"><li>Clicking <img src="img/back-button.png" alt="the Back button"> to navigate back to the page that displays all of the Skills.</li>
										<li>Within the tile for your Skill, clicking <img src="img/options-menu.png" alt="the Options menu icon"> and selecting <b>Export Conversation Log</b>.</li>
										<li>In the Export Skill dialog, selecting <b>Intent Conversation Log</b>.</li>
									</ol></li>
								<li>In the log, see what intents that your partner's utterances were assigned and see if they are what you would have expected.</li>
                            </ol>
                              <h3>Using Logs to Retrain the Skill</h3>
							<p>Using the phrases your testing partner added, you can do some further augmentation of your corpus, retrain your skill, and test the results.  Let's do that now.</p>

                            <ol>
								<li>Go through the utterances and identify any that you think won't work, and replace them or make changes that you see fit.</li>
                                <li>For each intent:
									<ol type="a"><li>Copy 2 of the utterances created by your test partner to your clipboard.</li>
										<li>Within the skill, select the intent.</li>
										<li>Within the Examples area, paste the utterances.</li>
										<li>Click the <b>Train</b> button.</li>
										<li>Leave <b>Trainer Ht</b> selected and click <b>Submit</b>.
									</ol></li>									
								</li>
								<li>Create a copy of <code>batchtest1.csv</code> and save it as <code>batchtest2.csv</code>.</li>
								<li>For each intent, add the remaining utterance created by your test partner to <code>batchtest2.csv</code>.</li>
								<li>Click <img src="img/tryItOut.png" alt="Try it out icon">.</li>
								<li>Select <b>Intent</b>.
								<li>Slide the <b>Batch</b> switch to ON.</li>
								<li>Click <b>Load</b>.</li>
								<li>Drag <code>batchtest2.csv</code> into the Load Batch dialog and click <b>Test</b>.</li>	
								<li>Evaluate the results of the new test. 
									<ul><li>Has the inclusion of new phrases helped in the intent resolution?</li>
										<li>Are you getting better results?</li>
										<li>Are you seeing obvious misclassifications?
										<p class="note">We'll look at fine tuning these later in the lab.</p></li>
									</ul> </li>
								<li>With your partner, or perhaps a new partner, repeat the exercises in this section with three more utterances for each intent.</li>
                            </ol>
                 <p><b>What you just did.</b>  Ideally you would want your skill to get smarter over time, but to do so you need to train it to be smarter.  Every time your skill is used you should be harvesting new training and test utterances from the conversation logs.  This is an essential best practice for any skill development.</p>
     						
                        </section>
                        <hr>
                        <section>
                            <h2 id="section_5" role="button" style="text-align: left;"><img src="./img/32_5.png" alt="section 5" height="32" width="32" class="num_circ">Train the Skill to Handle Spam</h2>
							<p>Now let's spend some time on the question of spam or other misuse of the skill. Up to 40% of a skill's workload may have nothing to do with the skill's intended use, and the skill needs to be able to gracefully handle this.  Furthermore, training your skill to understand phrases that are outside of the use case has the benefit of helping it to disambiguate the intents it <i>is</i> supposed to handle.</p>
							<ol>
								<li>Test the skill with 10 random phrases such as “and she is buying a stairway to heaven”, “tell me a joke”, and “are you a lady bot” by doing the following:
									<ol type="a">
										<li>Clicking <img src="img/testerIcon.png" alt="Tester icon">.</li>			
										<li>Typing a phrase in the Message field and pressing Enter.
										<p class="note">Repeat this step until you have entered 10 different random phrases.</p></li>
									</ol>
								</li>
								<li>Open the conversation logs by:
									<ol type="a"><li>Clicking <img src="img/back-button.png" alt="the Back button"> to navigate back to the page that displays all of the Skills.</li>
										<li>Within the tile for your skill, clicking <img src="img/options-menu.png" alt="the Options menu icon"> and selecting <b>Export Conversation Log</b>.</li>
										<li>In the Export Skill dialog, selecting <b>Intent Conversation Log</b>.</li>
									</ol></li>
								<li>In the log, see if any of the phrases are resolved to any of your intents.
								<p class="note">Spoiler alert: some of them probably are. You'll need to train the skill to recognize phrases that are outside of the scope of the skill and deal with them appropriately.</li>
							</ol>
							<h3>The <code>unresolvedIntent</code> Intent</h3>
							<p>To handle spam and other interactions for which the skill wasn't specifically designed, create a new intent called <code>unresolvedIntent</code>.</p> 
							<ol>
								<li>With your skill open, click <img src="img/intent.png" alt="the Intents icon">.</li>
								<li>Click <b>+ Intent</b>.</li>
								<li>In the Name field type <code>unresolvedIntent</code>.</li>
								<li>In the Examples area for the intent, enter 7 of the random utterances that you just evaluated in the log.</li>
								<li>Click <b>Train</b> and retrain the skill.</li>						
								<li>In the most recent version of your <code>batchtest.csv</code> file, add the three remaining phrases and specify <code>unresolvedIntent</code> as the intent.</li>
								<li>Click <img src="img/tryItOut.png" alt="Try it out icon">.</li>
								<li>Select <b>Intent</b>.
								<li>Slide the <b>Batch</b> switch to ON.</li>
								<li>Click <b>Load</b>.</li>
								<li>Drag your batchtest file into the Load Batch dialog and click <b>Test</b>.</li>	
								<li>Evaluate your test results.</li>
								<li>Try testing with the other training model by:
									<ol type="a">
										<li>Clicking <b>Train</b> again, selecting the other Intent Training model (probably <b>Trainer Tm</b>, and clicking <b>Submit</b>.</li>
										<li>Clicking <img src="img/tryItOut.png" alt="Test icon">.</li>
										<li>Selecting <b>Intent</b>.
										<li>Sliding the <b>Batch</b> switch to ON.</li>
										<li>Clicking <b>Load</b>.</li>
										<li>Dragging your batchtest file into the Load Batch dialog and clicking <b>Test</b>.</li>	
									</ol></li>
								<li>Compare the results with your previous results.</li>
							</ol>
							<p><b>Now, for good measure, do additional testing with your test partner:</b></p>
							<ol>
								<li>Have your partner enter 10 random phrases into the tester for your skill.</li>
								<li>Open the conversation logs to see what intents the phrases resolved to.</li>
								<li>Open your skill, and select the <code>unresolvedIntent</code> intent.</li>
								<li>Repeat steps 4-14 above to augment the <code>unresolvedIntent</code> with 7 of thew new phrases and add 3 to the batch test file.</li>
							</ol>

                             <p><b>What you just did.</b>  As well as training your model to understand your intents, it is also a good practice to train the model to understand what is <i>not</i> an intent.  You can do this by defining the <code>unresolvedIntent</code> which contains phrases unrelated to the intents that support the use case.
                            <br>By adding this you are helping your skill understand non-usecase specific phrases as well as helping avoid these phrases being incorrectly resolved to intents.</br></p>
	                   </section>
                        <hr>
                        <section>
                            <h2 id="section_6" role="button" style="text-align: left;"><img src="./img/32_6.png" alt="section 6" height="32" width="32" class="num_circ">Manually Improve the Skill</h2>
							<p>In the presentation associated with this lab you learn of a number of techniques to improve your skill intents.  Based on those lessons look at how you might improve some of the intent resolution.  For example, you could:</p>
							<ul>
								<li>Emphasize specific key phrases.</li>
								<li>Repeat key utterances with some slight variations.</li>
								<li>Check where you think utterances could apply to different intents.</li>
								<li>Try out some ideas and rerun your tests to see if that helps.</li>
							</ul>
							<p><b>Note:</b> Ultimately the best data for training your skill will come from real user utterances.  Furthermore, in most cases trainer Tm is better suited for resolving real-world phrases, however it does require more sample utterances to give those better resuts. </p>
							<p>In parallel with applying above techniques, you'll probably want to run and evaluate quality reports.</p>
							<p>To run a quality report:</p>
							<ol>
								<li>With your skill open, click <img src="img/quality_icon.png" alt="the Quality icon">.</li>
								<li>Click <b>Run Report</b>.</li>
							</ol>
							<p>When you run a quality report it performs a random 80:20 split of utterances, using 80% subset to train with and 20% to test with. Since the split is random, the test results may differ every time you run the report.</p>
						
							<p>Besides obvious problems such as misclassifications, here are some things to look out for in quality reports:</p>
							<ul>
								<li>Which of your phrases are resolving to <code>unresolvedIntent</code>. This gives you a way of checking that what comes back as unresolved <i>is</i> in fact a phrase which should be handled by a generic catch-all intent.
								<p class="note">To find out, click the <b>History</b> tab and do a search for matches to <code>unresolvedIntent</code>, like the one shown in this screenshot:</p>
								<br>
								<img src="img/qualityReportHistory_70.png" alt="screenshot showing the History screen of a quality report. A filter is defined (Top Intent Name, is equal to, unresolvedIntent). The Customer Message column has several entries, of which 'Do you like cheese' is selected. The Intent Data column shows three intents, the first of which is 'unresolvedIntent', which has a win margin of 30% and confidence level of 54%."></br>
								</li>
								<li>Which of your phrases are resolving to the correct intent, but with a narrow win margin? Such phrases may need work.
								<p class="note">To investigate, do a search with the filter set to <b>Win Margin</b>, the operator set to <b>Is Less Than</b>, and the value set to a low percentage, such as 20% (as shown in this screenshot):</p>
								<br>
								<img src="img/qualityReportWinMargin_70.png" alt="screenshot showing the History screen of a quality report. A filter is defined (Win Margin Name, Is Less Than, 20%). The Customer Message column has several entries, of which 'I want to complain' is selected. The Intent Data column shows three intents, the first of which is 'Open Franchise', which has a win margin of 2.3% and confidence level of 22%."></br>
								</li>
							</ul>
							
							
							<h3>Notes</h3>
							<ul>
								<li>At the time of writing this lab, the History feature only works against input through the skill Conversation tester (clicking <img src="img/testerIcon.png" alt="Tester">), not the intent or batch tester (clicking <img src="img/tryItOut.png" alt="Tester">). This means that you might have to manually enter some of your phrases in the Skill Conversation tester.</li>
								<li>Since quality reports do an 80:20 split between training and tester, some of the data you would normally use to train an intent will not be used as training material in the context of the report, which could result in misclassifications. For such misclassifications, you need to determine if they are simply a result of the way quality reports work or whether they are real and you need to add additional utterances.</li>
								<li>You may find some misclassification but decide that, if it resolves to a low percentage, it is acceptable.</li>
							</ul>
							



                        </section>
                        <hr>

                        <hr>
						<blockquote><h5><a href="../index.html">Back to the Index Page</a></h5></blockquote>

                    </article>
                </div>
                <br class="clearfloat">
            </div>
        </div>
        <!--close main--> 
        <!--end content-->
        <div class="footer-container ">
            <div style="max-width: 994px; padding:10px 0 0 17px;">
                <footer class="footer-list">
                    <ul>
                        <li> <a href="https://www.oracle.com/corporate/index.html" target="_blank">About Oracle</a> </li>
                        <li> <a href="https://www.oracle.com/us/corporate/contact/index.html" target="_blank">Contact Us</a> </li>
                        <li> <a href="https://www.oracle.com/us/legal/index.html" target="_blank">Legal Notices</a> </li>
                        <li> <a href="https://www.oracle.com/us/legal/terms/index.html" target="_blank">Terms of Use</a> </li>
                        <li> <a href="https://www.oracle.com/us/legal/privacy/index.html" target="_blank">Your Privacy Rights</a> </li>
                        <li><a href="https://www.oracle.com/pls/topic/lookup?ctx=cpyr&id=en">Copyright © 2018, Oracle and/or its affiliates. All rights reserved.</a></li>
                    </ul>
                </footer>
            </div>
            <script type="text/javascript" src="https://www.oracleimg.com/us/assets/metrics/ora_docs.js"></script>
        </div>
    </body>
</html>

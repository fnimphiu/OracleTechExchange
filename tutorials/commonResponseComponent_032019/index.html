<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Part number: Ennnnn-01 -->
    <!-- Published date: February 2019 -->
    <!-- Template date: October 15, 2018 -->
    <meta name="contentid" content="">
    <meta content="text/html; charset=utf-8" http-equiv="content-type">
    <title>How-to build composite bot responses with the Common Response component</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="robots" content="INDEX, FOLLOW">
    <meta name="description" content="This tutorial explains how to build simple and complex bot responses using the Oracle Digital Assistant Common Response Component.">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="css/normalize.min.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="css/obe-lite.css">
    <script src="js/jquery-1.11.0.min.js"></script>
    <script src="js/jquery-ui-1.10.4.custom.js"></script>
    <script src="js/jquery.tocify.jd.js"></script>
    <script src="js/leftnav.js"></script>
</head>

<body>
    <header>
        <div class="w1024" style="min-height:55px; display:block;">
            <a href="https://docs.oracle.com" class="oracle-logo"> <img src="img/oracle_doc_logo.png" alt="Oracle Documentation" style="max-width: none;" height="22" width="236"></a>
        </div>
    </header>
    <!--end header-->
    <div id="content">
        <!-- The title below is displayed as the title at the top of the OBE page. It can be shorter than the title in the <title> element, above. -->
        <!-- Use an imperative verb in the title. -->
        <h1><img src="img/obe_tag.png" align="middle" alt="Oracle by Example branding">How-to build composite bot responses with the Common Response component</h1>
        <div class="w1024" style="clear:both; position:relative; margin-top:40px;">
            <div class="navbackwide border-right">
                <!-- -->
            </div>
            <div id="shownav" title="Show Navigation" tabindex="0"><span class="fa fa-list"></span></div>
            <div id="sidebar">
                <!-- -->
                <div class="left-nav-tut">
                    <!-- -->
                    <div id="hidenavw" title="Hide Navigation" tabindex="0"><span class="fa fa-close"></span></div>
                    <div id="navbar" class="left-nav-w">
                        <!-- -->
                        <div id="toc" class="tocify">
                            <!-- -->
                        </div>
                    </div>
                </div>
            </div>
            <div id="bookContainer">
                <article>
                    <p style="text-align:justify"><span lang="EN-US"><b>
                                <font size="+1">Tutorial by Frank Nimphius, Oracle</font>
                            </b>
                            <br>
                            March 2019, Oracle Digital Assistant version 19.1.3<br>
                        </span></p>
                    <section>
                        <h2><img src="img/32_begin.png" alt="section 0" height="32" width="32" class="num_circ">Before You Begin</h2>
                        <h3>Background</h3>
                        <p style="text-align:justify"><span lang="EN-US">
                                Skills in Oracle Digital Assistant reference components in their dialog flow states to display bot responses and prompt for user input. The <code>System.CommonResponse</code> component is a powerful and flexible component that allows bot designers to create different types of user interfaces, such as: simple text boxes, value lists, card layouts, and complex answers that return media and image content.</p>
                        <p style="text-align:justify"><span lang="EN-US">In this tutorial you'll learn how to build user interfaces with the <code>System.CommonResponse</code> component that display data stored in dialog flow variables and that update dialog flow variables with user input.</span></p>
                        <h3>What you need to run this tutorial</h3>
                        <ul>
                            <li style="text-align:justify">For this tutorial, you need access to an instance of Oracle Digital Assistant Version 19.1.3 or later. Oracle Digital Assistant is available for trial and as a paid subscription. If you do not have access to Oracle Digital Assistant, visit the <a href="https://cloud.oracle.com/digital-assistant" alt="Oracle Digital Asisstant home page link"><b>Oracle Digital Assistant</b></a> website </li>
                            <li style="text-align:justify"><b>Download</b> the Oracle Digital Assistant starter skill bot from here: <a href="files/CRCTutorialSkill(1.0).zip" alt="download link for skill bot"><b>CRCTutorialSkill (zip)</b></a> </li>
                        </ul>
                    </section>
                    <!-- ========================================================================================================================= -->
                    <section>
                        <hr>
                        <h2 id="section_1" role="button" style="text-align: left;"><img src="img/32_1.png" alt="Getting Ready" height="32" width="32" class="num_circ">Getting Ready</h2>
                        <p style="text-align:justify"><span lang="EN-US">The use case in this tutorial is a pizza bot. The starter skill you downloaded for this tutorial contains intents and entities, as well as a starter dialog flow.</span></p>
                        <h3>Importing the starter skill to an Oracle Digital Assistant</h3>
                        <p style="text-align:justify">If you work in your own Oracle Digital Assistant instance, then you import the starter skill and use it for the tuorial. In a shared trainings environment, the starter skill most like exists already. In which case we recommend cloning the skill so that you have your own unique copy.</p>
                        <ol>
                            <li style="text-align:justify">Open the Oracle Digital Assistant browser based dashboard by pointing your browser to <b>&lt;your instance url&gt;/botsui</b>.</li>
                            <li style="text-align:justify">Select the menu icon at the top-left of the page next to the "Oracle Digital Asisstant" label (<img src="img/hamburger.png" alt="menu icon">). </li>
                            <li style="text-align:justify">Select the <b>Skills</b> option in the <b>Development</b> category.
                                <br>
                                <figure><img src="img/image_001.png" alt="Main Menu"></figure>
                            </li>
                            <li style="text-align:justify">Again, <b>click</b> on the menu icon at the top-left of the page to close the menu (<img src="img/hamburger.png" alt="menu icon">).</li>
                            <li style="text-align:justify">Click the <b>Import Skills</b> button on the top right (<img src="img/importSkillButton.png" height="25" alt="import skill button">).</li>
                            <li style="text-align:justify">On your computer, <b>browse</b> to the location you saved the dowloaded <b>CRCTutorialSkill(1.0).zip</b> file to.</li>
                            <li style="text-align:justify">Select the CRCTutorialSkill(1.0).zip file and click <b>Open</b> to upload and install the starter skill bot.</li>
                            <li style="text-align:justify">Locate the <b>CRC Tutorial Skill</b> and open it by clicking on the CRC Tutorial Skill tile.
                                <br>
                                <br><b>Note:</b> If you cannot find the <i>CRC Tutorial Skill</i> starter skill, then try and use the filter field above the <i>New Skill</i> tile to find it. </li>
                        </ol>
                        <h3>Cloning the starter skill</h3>
                        <p style="text-align:justify">If you are running this tutorial in an environment that is shared with other users, like in a training, you will need to <b>clone the skill</b> before you can use it. The reason is that you can only import a skill with a specific name once.</p>
                        <ol>
                            <li style="text-align:justify">Open the Oracle Digital Assistant browser based dashboard by pointing your browser to <b>&lt;your instance url&gt;/botsui</b>.</li>
                            <li style="text-align:justify">Select the menu icon at the top-left of the page next to the "Oracle Digital Asisstant" label (<img src="img/hamburger.png" alt="menu icon">). </li>
                            <li style="text-align:justify">Select the <b>Skills</b> option in the <b>Development</b> category.
                                <br>
                                <figure><img src="img/image_001.png" alt="Main Menu"></figure>
                            </li>
                            <li style="text-align:justify">Again, <b>click</b> on the menu icon at the top-left of the page to close the menu (<img src="img/hamburger.png" alt="menu icon">).
                            <li style="text-align:justify">If you cannot spot the <i>'CRC Tutorial Skill'</i> starter skill, then try and use the filter field above the <i>'New Skill'</i> tile to find it. If still you cannot find it, import the skill as explained in the previous section.</li>
                            <li style="text-align:justify">To clone a skill, select the menu icon on the <b>CRC Tutorial Skill</b> tile and select the <b>Clone</b> menu item as shown in the image below.
                                <br>
                                <figure><img src="img/skillCloning_1.png" alt="Cloning a skill"></figure>
                                <br>
                            </li>
                            <li style="text-align:justify">In the opened dialog, provide a display name with your initials in it (e.g. "FN_CRC Tutorial Skill").</li>
                            <li style="text-align:justify">Optionally, provide a description.</li>
                            <li style="text-align:justify">Create the clone and open it to start the tutorial.</li>
                        </ol>
                        <h3>Exploring the starter skill</h3>
                        <ol>
                            <li style="text-align:justify">If not open already, <b>open the intent builder</b> by selecting the Intents menu icon (<img src="img/intentBuilderIcon.png" height="25" alt="intent builder icon">).</li>
                            <li style="text-align:justify">There are two intents created for you: <b>Welcome</b> and <b>OrderPizza</b>. The 'OrderPizza' state resolves pizza orders from user input messages using natural language processing (NLP). For this, the intent has two entities configured: <b>PizzaType</b> and <b>PizzaSize</b>.</li>
                            <li style="text-align:justify">To train the skill, click the <b>Train</b> link in the upper right part of the header(<img alt="train button" src="img/trainLink.png" height="20" />).</li>
                            <li style="text-align:justify">In the opened dialog, keep the default settings and press the <b>Submit</b> button. Training the model may take a second or two.</li>
                            <li style="text-align:justify">To test the intent model, click the <b>Try It Out!</b> link in the upper right corner.</li>
                            <li style="text-align:justify">Type <i>'I like to order a large pizza pepperoni'</i> (without quotes) into the <b>Message</b> field and press the <b>Send</b> key.</li>
                            <li style="text-align:justify">Note that the intent tester indicates the <i>'OrderPizza'</i> intent with a probabily of 100% and that both entities, <i>'PizzaType'</i> and <i>'PizzaSize'</i> could extract their values from the user input.</li>
                            <li style="text-align:justify">Press the <b>Reset</b> botton in the tester header and type <i>'Gimme a pizza supreme'</i> (without quotes).</li>
                            <li style="text-align:justify"> Note that the returned confidence level for the <i>'OrderPizza'</i> intent. This time, however, only one of the two entities could be extracted from the user message, so that the bot dialog flow would need to explicitly ask for the pizza size to order.</li>
                            <li style="text-align:justify"><b>Close the intent tester</b> by clicking the close button (<img alt="close button" src="img/closeButton.png" height="25" />).</li>
                            <li style="text-align:justify"><b>Select</b> the entity icon from the menu (<img alt="entity icon" src="img/entity.png" height="25" />).</li>
                            <li style="text-align:justify">Notice the <i>'CheeseType'</i>, <i>'NoToppings'</i>, <i>'PizzaCrust'</i>, <i>'PizzaSize'</i>, <i>'PizzaToppings'</i> and <i>'PizzaType'</i> entities that contribute the information required for a pizza order. In this tutorial, to reduce the scope, you are going to work with the <i>'PizzaType'</i> and <i>'PizzaSize'</i> entties only.</li>
                            <li style="text-align:justify">Next, <b>open the dialog flow editor</b> (<img alt="dialog flow editor icon" src="img/dialogEditor.png" height="25" />). Note the existing dialog flow states to handle the user intents and unresolved intents.</li>
                            <li style="text-align:justify">And now it is your turn to complete the pizza order flow using the <code>System.CommonResponse</code> component.</li>
                        </ol>
                    </section>
                    <hr>
                    <section>
                        <h2 id="section_2" role="button" style="text-align: left;"><img src="img/32_2.png" alt="Building your first Common Response component" height="32" width="32" class="num_circ">Building A Conversation Using Text Prompts</h2>
                        <p style="text-align:justify">In this section you'll create a bot-user conversation that uses text prompts for the user to name a pizza type and the pizza size. Both text prompts are built using the <code>System.CommonResponse</code> component. To print the user choice, you create a confirmation dialog flow state that uses the <code>System.Output</code> component.</p>
                        <h3>Creating the orderPizza state</h3>
                        <ol>
                            <li style="text-align:justify">In the dialog flow editor, press the green <b>+ Components</b> button on top of the editor window (<img alt="+ components button" src="img/plusComponents.png" height="20" />).</li>
                            <li style="text-align:justify">In the opened popup dialog, select the <b>User Interface</b> category (<img alt="user interface tile" src="img/userInterface.png" height="25" />).</li>
                            <li style="text-align:justify">In the <b>User Interface</b> dialog, select the <b>Common response - text</b> menu entry.</li>
                            <li style="text-align:justify">Ensure the <b>Insert After</b> select list is set to <b>unresolved</b>, so the new component dialog flow state gets added to the end of the file.</li>
                            <li style="text-align:justify">Switch the <b>Remove Comments</b> toggle to on so the template content is added without its comments.</li>
                            <li style="text-align:justify">Click <b>Apply</b> to close the popup dialog.</li>
                            <li style="text-align:justify">Change the name of the added dialog flow state from <b>textResponse</b> to <b>orderPizza.</b></li>
                            <li style="text-align:justify">Change the <b>orderPizza</b> state so it looks like shown in the image below.
                                <br>
                                <br>
                                <figure><img src="img/orderPizza_1.png" alt="orderPizza state"></figure>
                            </li>
                        </ol>
                        <p style="text-align:justify"><b>Note: </b> The table below explains the properties you set on the <code>System.CommonResponse</code> component
                            <br>
                            <table class="body-table" style="text-align:justify" summary="This table ...">
                                <tr>
                                    <th scope="col">Property</th>
                                    <th scope="col">Use</th>
                                </tr>
                                <tr>
                                    <td scope="row">variable</td>
                                    <td>Value references the dialog flow variable that is updated with the user input</td>
                                </tr>
                                <tr>
                                    <td scope="row">nlpResultvariable</td>
                                    <td>References a dialog flow variable of type nlpresult (iResult in this tutorial). The variable reference is used to suppress component rendering if the pizzaType infromation could be extracted from natural language processing.</td>
                                </tr>
                                <tr>
                                    <td scope="row">processUserMessage</td>
                                    <td>If set to true, then the <code>System.CommonResponse</code> component displays as an input component. If set to false, the component behaves like an output component.</td>
                                </tr>
                            </table>
                        </p>
                        <br>
                        <h3>Creating the askSize state</h3>
                        <ol>
                            <li style="text-align:justify">Press the green <b>+ Components</b> button on top (<img alt="+ components button" src="img/plusComponents.png" height="20" />) of the dialog flow editor.</li>
                            <li style="text-align:justify">In the opened dialog, select the <b>User Interface</b> category (<img alt="user interface tile" src="img/userInterface.png" height="25" />).</li>
                            <li style="text-align:justify">In the <b>User Interface</b> dialog, select the <b>Common response - text</b> menu item.</li>
                            <li style="text-align:justify">Ensure the <b>Insert After</b> select list is set to <b>orderPizza</b>.</li>
                            <li style="text-align:justify">Ensure the <b>Remove Comments</b> toggle to be switched on.</li>
                            <li style="text-align:justify">Click <b>Apply</b>.</li>
                            <li style="text-align:justify">Change the name of the added dialog flow state from <b>textResponse</b> to <b>askSize</b>.</li>
                            <li style="text-align:justify">Change the <b>askSize</b> state so it looks like shown in the image below.
                                <br>
                                <br>
                                <figure><img src="img/askSize_1.png" alt="askSize state"></figure>
                            </li>
                            <br>
                            <li style="text-align:justify">Edit the component properties as shown in the table below.
                                <br>
                                <br>
                                <table summary="This table show the properties that need to be changed in the Common Response component">
                                    <tr>
                                        <th scope="col">Property</th>
                                        <th scope="col">Value</th>
                                    </tr>
                                    <tr>
                                        <td scope="row">variable</td>
                                        <td>"pizzaSize"</td>
                                    </tr>
                                    <tr>
                                        <td scope="row">nlpResultVariable</td>
                                        <td>"iResult"</td>
                                    </tr>
                                    <tr>
                                        <td scope="row">text</td>
                                        <td>"What size of pizza do you like?"</td>
                                    </tr>
                                </table>
                                <br>
                            </li>
                        </ol>
                        <h3>Creating the confirmOrder state</h3>
                        <ol>
                            <li style="text-align:justify">One last time (at least for now), press the green <b>+ Components</b> button on top (<img alt="+ components button" src="img/plusComponents.png" height="20" />) of the dialog flow editor.</li>
                            <li style="text-align:justify">In the opened dialog, select the <b>User Interface</b> category (<img alt="user interface tile" src="img/userInterface.png" height="25" />).</li>
                            <li style="text-align:justify">In the <b>User Interface</b> dialog, select the <b>Output</b> menu item.</li>
                            <li style="text-align:justify">Ensure the <b>Insert After</b> select list is set to <b>askSize</b>.</li>
                            <li style="text-align:justify">Ensure the <b>Remove Comments</b> toggle is switched on.</li>
                            <li style="text-align:justify">Click <b>Apply</b>.</li>
                            <li style="text-align:justify">Change the added dialog flow state name from <b>output</b> to <b>confirmOrder</b></li>
                            <li style="text-align:justify">Add the following string to the <b>text</b> property (including the quotes):
                                <br>
                                <br><i>"Your order of a ${pizzaSize.value?lower_case} ${pizzaType.value?capitalize} pizza is on its way"</i></li>
                            <li style="text-align:justify">Add a <b>transitions</b> element as shown in the image below.
                                <br>
                                <figure><img src="img/confirmOrder_1.png" alt="confirmOrder state"></figure>
                            </li>
                        </ol>
                        <br>
                        <p style="text-align:justify"><b>Note: </b>The confirmation message contains two Apache FreeMarker expressions "?lower_case" and "?capitalize". Apache Freemarker is an open source template language that can be used in Oracle Digital Assistant to e.g. format text messages. In this pizza example, the message values for pizza type and size are read from the entity. The pizza type value is defined all upper case in the entity, while the pizza size is defined with a capitalized first letter. </p>
                        <p style="text-align:justify">Both entity values would appear odd when displayed to a user. Using Apache Freemarker, the entity values are formatted such that the pizza type starts with an uppercase letter, followed by all lowercase letters, and the pizza size is printed in all lowercase.</p>
                        <p style="text-align:justify"><b>Note: </b> You could also have used the <code>System.CommonResponse</code> component in the <i>'confirmOrder'</i> state to confirm the pizza order. However, given that you ony needed to print a text message as a confirmation, using the <code>System.Output</code> component is the best choice. Only because the <code>System.CommonResponse</code> component can build any user interface, it does not mean it has to be used.</p>
                        <h3>Testing</h3>
                        <ol>
                            <li style="text-align:justify">Before you can test the pizza order skill, ensue your edits are valid and well formatted. For this, press the <b>Validate</b> link on top of the dialog flow editor. (<img alt="Validate link" src="img/validateLink.png" height="20" />)
                                <br>
                                <br> <b>Note: </b>If you see any validation errors, hover the mouse over the red error marker on the left margin to learn about the cause. Most likely it is that you got the indenting of elements wrong. The dialog flow editor requires each indenting to be exactly two blank characters. So, counting from the left margin, the first two blanks point to the state name, the next two blanks (blanks 3 and 4)then point to the component, properties and transitions elements. The next 2 indents then point to child elements of the prperties and the transitions elements.</li>
                            <li style="text-align:justify">To test the conversation flow, press the embedded conversation tester icon (<img alt="Embedded conversation tester icon" src="img/testerIcon.png" height="20" />) in the menu bar to the left.</li>
                            <li style="text-align:justify">In the <b>Message</b> field type <i>I like to order pizza</i> and press the <b>enter-key</b> on your keyboard.</li>
                            <li style="text-align:justify">When prompted for specifying a pizza type, enter <b>pepperoni</b> into the <i>Message</i> field and press the enter-key.</li>
                            <li style="text-align:justify">When prompted to enter a pizza size, type <b>large</b> into the message field and press the enter-key on your keyboard.</li>
                            <li style="text-align:justify">You should see a confirmation message <i>Your order of a large Pepperoni pizza is on its way</i>.</li>
                            <li style="text-align:justify">Click the <b>Reset</b> link on the top right of the embedded tester</li>
                            <li style="text-align:justify">Then, close the embedded conversation tester by clicking the 'X' located in the upper right part of the header(<img alt="Close icon" src="img/closeButton.png" height="25" />)</li>
                        </ol>
                    </section>
                    <hr>
                    <section>
                        <h2 id="section_3" role="button" style="text-align: left;"><img src="img/32_3.png" alt="section 3" height="32" width="32" class="num_circ">Building Select Lists</h2>
                        <p style="text-align:justify">Though your pizza bot works, the user experience needs some improvement. So, instead of displaying input prompts to the user for providing the pizza type and pizza size information, in this part of the tutorial you are going to display list-of-values instead. Good for you to know that the <code>System.CommonResponse</code> component makes the creation of list-of-values easy.</p>
                        <p style="text-align:justify">To build list of values with the <code>System.CommonResponse</code> component, you can start from scratch using the dialog flow builder component templates, or modify the existng text prompt. In the following you are doing both: For the <i>orderPizza</i> dialog flow state you will use the component template, while for the <i>askSize</i> state you are going to extend the component definition with a list.</p>
                        <h3>Displaying a list-of-values for the orderPizza state</h3>
                        <p style="text-align:justify">
                            <ol>
                                <li style="text-align:justify">In the dialog flow editor, press the components template button (<img alt="+ Components" src="img/plusComponents.png" height="25" />).</li>
                                <li style="text-align:justify">In the opened popup dialog, select the <b>User Interface</b> category (<img alt="User Interface option" src="img/userInterface.png" height="25" />).</li>
                                <li style="text-align:justify">Select the <b>Common response - text</b> link.</li>
                                <li style="text-align:justify">Set the <b>Insert After</b> select field to <b>orderPizza</b>.</li>
                                <li style="text-align:justify">Ensure the <b>Remove Comments</b> toggle is switched on.</li>
                                <li style="text-align:justify">Press the <b>Apply</b> button.</li>
                                <li style="text-align:justify"><b>Delete</b> the <b>orderPizza</b> state so that the <i>textResponse</i> state shows directly under the <i># TUTORIAL START</i> comment (as shown in the image below):
                                    <br>
                                    <figure><img src="img/textResponse_1.png" alt="textResonse state"></figure>
                                </li>
                                <li style="text-align:justify">Rename the <b>textResponse</b> state name to <b>orderPizza</b>.</li>
                                <li style="text-align:justify">Set the <b>variable</b> property to <b>"pizzaType"</b>.</li>
                                <li style="text-align:justify">Set the <b>nlpResultVariable</b> property to <b>"iResult"</b>.</li>
                                <li style="text-align:justify">Remove the <b>autoNumberPostbackActions</b> and <b>translate properties</b>.</li>
                                <li style="text-align:justify">The <b>responseItems</b> element contains two text responses. <b>Remove</b> the first text response by deleting the block of code that is highlighted in the image below.
                                    <figure><img src="img/removeBlockOfCode_1.png" alt="Block of code to remove"></figure>
                                </li>
                                <li style="text-align:justify">Edit the remaining text response item to look as shown in the image below.
                                    <figure><img src="img/orderPizza_5.png" alt="text response with action items"></figure>
                                </li>
                                <li style="text-align:justify">Click the <b>Validate</b> link on top of the dialog flow editor. If there are any formatting errors, fix them before you progress.</li>
                            </ol>
                            <p style="text-align:justify"><b>What you just did:</b> Using the <code>System.CommonResponse</code>component, a list of values is created by adding action items to a text response. The following table explains the properties you set and what their values actually do.</p>
                            <table class="body-table" summary="This table shows the response item action properties and explains their values" style="text-align:justify">
                                <tr>
                                    <th scope="col">Property</th>
                                    <th scope="col">Use</th>
                                </tr>
                                <tr>
                                    <td scope="row">iteratorVariable</td>
                                    <td>List items can be created (stamped) from an iterator. The <i>PizzaType</i> entity is of type <i>value list</i>, which means that it has a list of values defined that can be accessed through the <i>pizzaType</i> dialog flow variable.</td>
                                </tr>
                                <tr>
                                    <td scope="row">label</td>
                                    <td>When the list data is read from a value-list entity, then the currently stamped item is accessed through the <i>${enumValue}</i> expression. An Apache FreeMarker expression <i>?capitalize</i> is used to create a user-friendly message format form the all-uppercase pizza type names in the entity.</td>
                                </tr>
                                <tr>
                                    <td scope="row">variables</td>
                                    <td>List item actions (postback actions) can update one or many variables when a user taps on an item in the list. In the pizza skill, there is only one dialog flow variable <i>pizzaType</i> that needs to be updated. The string <i>pizzaType: "${enumValue}"</i> assigns the current iterator value to the variable. So if, for example, a user taps on the "Pepperoni" list item, the value 'PEPPERONI' is saved to the dialog flow variable.</td>
                                </tr>
                            </table>
                            <h3>Testing</h3>
                            <p style="text-align:justify">Before building the list-of-values for the <i>askSize state</i>, let's have a quick test of the <i>orderPizza</i> list-of-values.</p>
                            <ol>
                                <li style="text-align:justify">Open the embedded conversation tester (<img alt="embedded tester icon" src="img/testerIcon.png" height="25" />).</li>
                                <li style="text-align:justify">If needed, click the <b>Reset</b> link located in the header (<img alt="reset icon" src="img/resetLink.png" height="25" />). </li>
                                <li style="text-align:justify">In the <b>Message</b> field, type <i>"I like to order pizza".</i>
                                <li style="text-align:justify">You should see the following response:
                                    <br>
                                    <figure><img src="img/crcListResponse_1.png" alt="Response showing a list"></figure>
                                </li>
                                <li style="text-align:justify"><b>Select a pizza</b> from the list, e.g. <i>Meat Lover.</i></li>
                                <li style="text-align:justify">When prompted for a pizza size, <b>type</b> <i>large</i> and press the enter-key.</li>
                                <li style="text-align:justify">You should see a confirmation message containing the selected pizza type and pizza size you entered</li>
                                <li style="text-align:justify"><b>Reset</b> the conversation in the conversation tester.</li>
                                <li style="text-align:justify"><b>Close</b> the tester window by clicking on the 'X' icon.</li>
                            </ol>
                            <p style="text-align:justify"><b>Note: </b>Skill users can also use the Message field of the tester to type the pizza type value. The list-of-values is only an additonal, more user-friendly, option to provide user input.</p>
                    </section>
                    <h3>Displaying a list-of-values for the askSize state</h3>
                    <p style="text-align:justify">At current, the <i>askSize</i> state renders as an input prompt. In this section you are extending the prompt response to also show a list-of-values.</p>
                    <ol>
                        <li style="text-align:justify">If not still open, <b>open</b> the dialog flow editor and navigate to the <b>askSize</b> state.</li>
                        <li style="text-align:justify">Edit the askSize state so it looks like in the image below. The changes you need to apply are highlighted in the image.
                            <figure><img src="img/askSize_2.png" alt="ask size state with changed content"></figure>
                        </li>
                        <li style="text-align:justify">Press the <b>Validate</b> button to ensure correct indenting of the added configuration.
                    </ol>
                    <p style="text-align:justify"><b>What you just did:</b> You extended the <code>System.CommonResponse</code> component in the <i>'askSize'</i> state with a list of values defined in the <i>actions</i> configuration. The <i>PizzaSize</i> entity too is of type 'value list', so that the list of values can be read from the <i>pizzaSize</i> dialog flow variable. (<code>pizzaSize.type.enumValues</code>)</p>
                    <h3>Testing</h3>
                    <ol>
                        <li style="text-align:justify">Open the embedded conversation tester (<img alt="embedded tester icon" src="img/testerIcon.png" height="25" />).</li>
                        <li style="text-align:justify">In the <b>Message</b> field, type <i>"I like to order pizza"</i>.</li>
                        <li style="text-align:justify">Select a pizza type from the displayed list, e.g. <i>Meat Lover</i>.</li>
                        <li style="text-align:justify">You are then prompted for selecting a pizza size. Select one of the values from the list.</li>
                        <li style="text-align:justify">You should see a confirmation message containing the selected pizza type and pizza size.
                            <br> </li>
                        <li style="text-align:justify"><b>Reset</b> the conversation.</li>
                        <li style="text-align:justify">In the <b>Message</b> field, type <i>"I like to order pizza with pepperoni" and press the enter-key.</i></li>
                        <li style="text-align:justify">You should be prompted for providing a pizza size.
                            <br>
                            <br><b>Note: </b>You get prompted for selecting a pizza size instead of selecting a pizza type first because the <i>pizzaType</i> information is extracted from the user message using NLP. This actually works because of the <i>nlpResultVariable</i> property of the <code>System.CommonResponse</code> component that you have set to "iResult".
                        <li style="text-align:justify">Instead of selecting a pizza size, <b>type</b><i>"Hmm, I like a large pizza"</i>.</li>
                        <li style="text-align:justify">You should see a response similar to the response shown in the image below:
                            <br>
                            <figure><img src="img/tester_1.png" alt="Conversation response for NLP and entity extraction"></figure>
                            <br><b>Note:</b> The <i>variable</i> property of the <code>System.CommonResponse</code> component of the <i>askSize</i> state references a dialog flow variable of type "PizzaSize". Any value that you provide when prompted for a pizza size is validated against the entity. The text message <i>'Hmm, I like a large pizza'</i> contains a valid size information (large) and thus the value gets extracted.
                        </li>
                        <li style="text-align:justify"><b>Reset</b> the conversation in the conversation tester.</li>
                        <li style="text-align:justify">As a last test, type <i>"I like to order a pizza"</i> into the message field and press the enter-key.</li>
                        <li style="text-align:justify">When prompted for selecting a pizza, <b>type</b><i>"salad"</i>
                            <br>
                            <br> <b>Note:</b> Again, the provided value is validate against the list of pizzas in the entity. Since salad is not a valid entity type, the list of pizza is displayed again.</li>
                        <br>
                        <li style="text-align:justify"><b>Reset</b> the conversation in the conversation tester.</li>
                        <li style="text-align:justify"><b>Close</b> the tester window by clicking on the 'X' icon.</li>
                    </ol>
                    <h3>Using keywords to select list items</h3>
                    <p style="text-align:justify">Both dialog flow states, <b>orderPizza</b> and <b>askSize</b>, use stamped actions to render the list items. The action definition contains a <b>keyword</b> property, that has an empty value assigned. Keywords allow you to define shortcuts that users can type into the message field to select an action (a list item). You can define a keyword or a sequence of keywords concatenated with a comma. E.g. keyword: "l,L,grand,max" to provide shortcuts that select a <i>large</i> size for a pizza.
                        <br>
                        <br>In this tutorial, the value list is dynamically created from values provided by the <i>PizzaType</i> and <i>PizzaSize</i> entities. This means that keywords need to be generated from the list-of-values content. Next, you are creating keywords for the <i>askSize</i> state</p>
                    <ol>
                        <li style="text-align:justify">Navigate to the <b>askSize</b> state.</li>
                        <li style="text-align:justify">Add the following string as a value to the <b>keyword:</b> property:
                            <br>
                            <br> <code>"${enumValue[0]?upper_case},${(enumValue?index)+1}" </code></li>
                        <li style="text-align:justify">Change the <b>label:</b> property value to:
                            <br>
                            <br> <code>"(${enumValue[0]?upper_case})${enumValue?keep_after(enumValue[0])}"</code>
                            <br>
                        </li>
                        <li style="text-align:justify">The <b>askSize</b> state should now look like shown in the image below
                            <figure><img src="img/askSize_3.png" alt="keyword proprty in CR component"></figure>
                        </li>
                        <li style="text-align:justify">Click the <b>Validate</b> button to ensure correct formatting and indenting.</li>
                    </ol>
                    <p style="text-align:justify"><b>What you just did:</b> You used Apache Freemarker expressions to define keywords as the first letter of the pizza size value (e.g. "L" or "l" for "Large"), as well as a numeric value, which matches the position of the item in the list (e.g. 1 for "Large", 2 for "Medium") </p>
                    <h3>Testing</h3>
                    <ol>
                        <li style="text-align:justify">Open the embedded conversation tester.</li>
                        <li style="text-align:justify">In the Message field, type <i>I like to order pizza.</i>.</li>
                        <li style="text-align:justify">Select a pizza type from the displayed list, e.g. Meat Lover.</li>
                        <li style="text-align:justify">You are prompted for selecting a pizza size. Notice the different look of the list labels.
                            <br>
                            <br>
                            <figure><img src="img/askSize_4.png" alt="list item labels showing leading character in brackets"></figure>
                        </li>
                        <li style="text-align:justify"> Instead of selecting a value from the list, type e.g. <b>L</b> and press enter. You should see a confirmation for a large pizza "Meat Lover".</li>
                        <li style="text-align:justify"><b>Reset</b> the converation.</li>
                        <li style="text-align:justify">In the Message field, type <i>I like to order pizza</i>.</li>
                        <li style="text-align:justify">Select a pizza type from the displayed list.</li>
                        <li style="text-align:justify">When asked for a size, type the numeric value 2. You should see a message confirming that you ordered a medium size pizza.</li>
                        <li style="text-align:justify"><b>Reset and close</b> the embedded conversation tester</li>
                    </ol>
                    <h3>On your own</h3>
                    <p style="text-align:justify">You added keyword support for the <i>askSize</i> dialog flow state. It is now on you to do the same for the <i>orderPizza</i> state. This, however, comes with a challenge. The list-of-values in the <i>orderPizza</i> state continues values with the same initial letter. So, to create a unqiue shortcut, your implementation should use the first two characters of a pizza type name as the keyword.</p>
                    <p style="text-align:justify">This should not take more that <b>10 minutes</b> for you to build.</p>
                    <hr>
                    <section>
                        <h2 id="section_4" role="button" style="text-align: left;"><img src="img/32_4.png" alt="section 4" height="32" width="32" class="num_circ">Creating a Card Layout</h2>
                        <p style="text-align:justify">Messengers like Facebook and the Oracle Digital Assistant Client SDK for JavaScript, support rich user interface components. A popular layout with these messengers is the cards layout. Cards layouts can print cards vertically, or horizontally as a carousel of cards. In this part of the tutorial will change the <i>orderPizza</i> state to render pizza types using cards with images.</p>
                        <h3>Displaying pizzas in cards</h3>
                        <ol>
                            <li style="text-align:justify"><b>Create a new line</b> under the <b>states:</b> element in the dialog flow.</li>
                            <li style="text-align:justify">Open the <a href="files/pizza_menu.txt" target="_blank">pizza_menu.txt file</a> and <b>copy its content to the clipboard</b>. For the ease of demonstration, the code you copy defines an object which describes all of the various pizza types and images for them</li>
                            <li style="text-align:justify">Paste the content into the dialog flow and <b>align</b> it so it looks like shown in the image below.
                                <br>
                                <br> <b>Note:</b> Each indent is exactly two blank characters.
                                <figure><img src="img/loadPizzacardInfo.png" alt="state loading the pizza menu"></figure>
                            </li>
                            <li style="text-align:justify">Press the <b>Validate</b> button to ensure your dialog flow is well formatted after adding the code from the file.</li>
                            <li style="text-align:justify"><b>Delete</b> the <b>orderPizza</b> state.</li>
                            <li style="text-align:justify">Scroll to he top of the dialog flow builder and <b>click</b> the <b>+ Components</b> button (<img alt="+ components" src="img/plusComponents.png" height="20" />).</li>
                            <li style="text-align:justify">In the component template popup dialog, select the <b>User Interface</b> category and then the <b>Common response - card</b> menu item.</li>
                            <li style="text-align:justify">Set the <b>Insert After</b> list value to <b>unresolved</b>.</li>
                            <li style="text-align:justify">Ensure the <b>Remove Comments</b> toggle is enabled abd press <b>Apply</b>.</li>
                            <li style="text-align:justify">Rename the <b>cardResponse</b> state name to <b>orderPizza</b></li>
                            <li style="text-align:justify">This tutorial does not need all of the <code>System.CommonResponse</code> component properties. <b>Edit</b> the <i>orderPizza</i> state so it looks as shown in the image below .
                                <figure><img src="img/orderPizza_2.png" alt="orderPizza state with cards"></figure>
                            </li>
                            <li style="text-align:justify">Press the <b>Validate</b> button to ensure the component state to be valid.</li>
                            <li style="text-align:justify">Edit the <b>orderPizza</b> state following the instructions in the table below. The image below the table provides you with a visual clues of how ths should look in the end.
                                <br>
                                <table style="text-align:justify" summary="pizza order state changes">
                                    <tr>
                                        <th scope="col">Property</th>
                                        <th scope="col">Value</th>
                                        <th scope="col">Action</th>
                                    </tr>
                                    <tr>
                                        <td scope="row"></td>
                                        <td></td>
                                        <td>Create the <b>variable</b> property below the <i>processuserMessage</i> property.</td>
                                    </tr>
                                    <tr>
                                        <td scope="row">variable</td>
                                        <td>"pizzaType"</td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td scope="row"></td>
                                        <td></td>
                                        <td>Create the <b>nlpResultVariable</b> property below the <i>variable</i> property.</td>
                                    </tr>
                                    <tr>
                                        <td scope="row">nlpResultVariable</td>
                                        <td>"iResult"</td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td scope="row">cardLayout</td>
                                        <td>"horizontal"</td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td scope="row">iteratorVariable</td>
                                        <td>"pizzaType.type.enumValues"</td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td scope="row">title</td>
                                        <td>"${enumValue}"</td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td scope="row">description</td>
                                        <td>"${pizzaCardInfo.value[enumValue].description}"</td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td scope="row">imageUrl</td>
                                        <td>"${pizzaCardInfo.value[enumValue].image}"</td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td scope="row">cardUrl</td>
                                        <td></td>
                                        <td>Delete property</td>
                                    </tr>
                                    <tr>
                                        <td scope="row">payLoad-->action</td>
                                        <td>"selectPizza"</td>
                                        <td>Set <i>action</i> property in <i>payload</i> element to "selectPizza"</td>
                                    </tr>
                                    <tr>
                                        <td scope="row">label</td>
                                        <td>"Order ${enumValue?capitalize}"</td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td scope="row">user.someVariable</td>
                                        <td></td>
                                        <td>Change name to <b>pizzaType</b></td>
                                    </tr>
                                    <tr>
                                        <td scope="row">pizzaType</td>
                                        <td>"${enumValue}"</td>
                                        <td> </td>
                                    </tr>
                                </table>
                                <br> The <b>orderPizza</b> state should now look as shown in the image below.
                                <br>
                                <figure><img src="img/orderPizza_2_2.png" alt="Edited orderPizza state"></figure>
                            </li>
                            <li style="text-align:justify">Edit the <b>transitions:</b> element so it looks as shown in the image below.
                                <figure><img src="img/orderPizza_3.png" alt="transitions with new 'actions' element"></figure>
                            </li>
                            <li style="text-align:justify">With all these changes, the orderPizza state should now look like shown in the image below.
                                <figure><img src="img/orderPizza_4.png" alt="orderPizza state"></figure>
                            </li>
                            <li style="text-align:justify">Press the <b>Validate</b> button to ensure all formatting and indenting is still valid.</li>
                        </ol>
                        <p style="text-align:justify"><b>What you just did: </b> In this section, you changed the bot response rendered by the <code>System.CommonResponse</code> component from a list type to a cards layout.
                            <br>
                            <br>The "LoadPizzaCardInfo" state you copied from the provided pizza_menu.txt file uses Apache FreeMarker expressions to build a pizza menu object. In a production system, this object would be queried from a remote service using a custom component and then saved into a dialog flow variable.
                            <br>
                            <br>As before, the card layout uses an iterator (the enum values of the PizzaType entity) to print the individual cards. The pizza names are used as a key name in the pizza menu object (pizzaCardInfo) to retrieve the image URL and description.
                            <br>
                            <br>The <i>actions</i> element defines the buttons to be placed on a card. In the tutorial, each card is rendered with a single button to order the displayed pizza. Pressing the button updates the <i>pizzaType</i> variable with the name of the pizza. At the same time, the <i>selectPizza</i> custom action is followed. The <i>selectPizza</i> custom action is mapped to the <i>askSize</i> state, so navigation continues to asking for the pizza size.</p>
                        <p style="text-align:justify"><b>Why is the "next" transition set to the same dialog flow state as the "selectPizza" transition?</b> The <i>selectPizza</i> action transition is followed when a user clicks the button on a card. However, if the initial user message contained the name of the pizza to order, in which case natural language processing extracts it, then the <i>next</i> transition is followed. Selecting a button action may result in a diferent dialog flow state to be visited, which is why it is good practice to define a separate action transition for it.</p>
                        <h3>Testing</h3>
                        <ol>
                            <li style="text-align:justify">Open the embedded tester (<img alt="embedded tester" src="img/testerIcon.png" height="20" />).</li>
                            <li style="text-align:justify">Reset the conversation if needed.</li>
                            <li style="text-align:justify"><b>Type</b> <i>I like to order pizza</i> into the <b>Message</b> field and press the enter key</li>
                            <li style="text-align:justify">Use the <b>navigation arrow</b> displayed on the right side of the card to navigate to the second pizza.</li>
                            <li style="text-align:justify">Press the <b>Order</b> button</li>
                            <li style="text-align:justify">Select a pizza size. You should see a conversation history similar to the one shown in the image below
                                <figure><img src="img/cardLayoutTesting.png" alt="Card layout testing"></figure>
                            </li>
                            <li style="text-align:justify">Reset the conversation (<img alt="Reset icon" src="img/resetLink.png" height="25" />).</li>
                            <li style="text-align:justify">Type <i>I like to order a pepperoni pizza</i> into the <b>Message</b> field and press the <i>enter-key</i>.</li>
                            <li style="text-align:justify">Notice that the card layout with the pizzas does not show and you are directly asked for the pizza size. This is because of the <i>variable</i> and <i>nlpResultVariable</i> properties you set on the <code>System.CommonResponse</code> component.</li>
                            <li style="text-align:justify"><b>Reset</b> the conversation and close the embedded conversation tester.</li>
                        </ol>
                    </section>
                    <h3>Adding keyword support to the cards</h3>
                    <p style="text-align:justify">When working with card layouts, it is not the card you select to perform a selection, but the button(s) displayed on a card. In this tutorial, each card displays a single button for ordering the displayed pizza. Following the next steps, you will implement keyword support for buttons in the cards.</p>
                    <ol>
                        <li style="text-align:justify">In the <i>orderPizza</i> dialog flow state, replace the <b>label</b> property value contained in metadata --> cards --> actions with the following string:
                            <p style="text-align:left"><code>"Order (${enumValue[0]?upper_case}${enumValue[1]?upper_case})${enumValue?keep_after(enumValue[1])}"</code></p>
                        </li>
                        <li style="text-align:justify">Edit the <b>keyword:</b> property below and assign the following expression string as a value:
                            <br>
                            <br> <code>"${enumValue[0]?upper_case}${enumValue[1]?upper_case}</code>"
                            <br> </li>
                        <li style="text-align:justify">The card actions configuration should look similar to the highlighted section in the image below:
                            <br>
                            <figure><img src="img/orderPizza_11.png" alt="Card layout with keywords"></figure>
                        </li>
                        <li style="text-align:justify">Open the embedded tester.</li>
                        <li style="text-align:justify">Type <i>I like to order pizza</i> into the message field and press the enter-key. The pizza menu should display as shown in the image below.
                            <br>
                            <figure><img src="img/cardLayoutWithKeywordTesting.png" alt="Pizza menu with keyword selection highlighted"></figure>
                            <br>
                        </li>
                        <li style="text-align:justify">Note the (CH) in the "Order (CH)EESE BASIC" card button label.</li>
                        <li style="text-align:justify">Type <b>ch</b> into the message field to order a cheese pizza.</li>
                        <li style="text-align:justify">Press the enter-key.</li>
                        <li style="text-align:justify">Select <b>large</b> as the pizza size when prompted for it. The bot should confirm your order of a large cheese pizza.</li>
                        <li style="text-align:justify">Reset the tester.</li>
                        <li style="text-align:justify">Type <i>I like to order pizza</i> into the message field and press the enter-key.</li>
                        <li style="text-align:justify">With the CHEESE BASIC pizza card displayed, type <b>pe</b> into the message field and press the enter-key.</li>
                        <li style="text-align:justify">Type <b>l</b> into the message field when asked for the pizza size and press the enter-key. The bot should confirm your order of a large pizza Pepperoni.</li>
                        <li style="text-align:justify">Reset and close the tester.</li>
                    </ol>
                    <p style="text-align:justify"><b>Note:</b> There are two observations with this latest exercise. Firstly, the keyword uses two letters to make a pizza selection. This is because two pizzas, pepperoni and premium, start with a "P" as the first character. So a single letter keyword does not work. Secondly, the keyword selection does work even if a card is not displayed. Note, however, that if you use page ranging to reduce the number of cards rendered at a time (some messengers like Facebook require this), then only those cards can be accessed with a keyword shortcut that are within the current page range.</p>
                    <hr>
                    <hr>
                    <section>
                        <h2 id="section_2" role="button" style="text-align: left;"><img src="img/32_6.png" alt="..." height="32" width="32" class="num_circ">Summary</h2>
                        <p style="text-align:justify">The <code>System.CommonResponse</code> component is a powerful system component that bot designers can use to build simple and complext bot responses. This tutorial provided a basic overview of the <code>System.CommonResponse</code> component that gets you started in your chatbot UI development. The dialog flow component templates contain pre-defined dialog flow configurations you can use as starters. The component templates also provide comments for each <code>System.CommonResponse</code> component property for you to learn about and try. </p>
                        <p style="text-align:justify">Though the <code>System.CommonResponse</code> component is powerful, it does not mean that it is the only tool in your box. As you used the <code>System.Output</code> component to confiem the ordered pizza, you should also spend some time exploring the other user interface components in Oracle Digital Assistant.</p>
                    </section>
                </article>
            </div>
            <br class="clearfloat">
        </div>
    </div>
    <!--close main-->
    <!--end content-->
    <div class="footer-container ">
        <div style="max-width: 994px; padding:10px 0 0 17px;">
            <footer class="footer-list">
                <ul>
                    <li> <a href="https://www.oracle.com/corporate/index.html" target="_blank">About Oracle</a> </li>
                    <li> <a href="https://www.oracle.com/us/corporate/contact/index.html" target="_blank">Contact Us</a> </li>
                    <li> <a href="https://www.oracle.com/us/legal/index.html" target="_blank">Legal Notices</a> </li>
                    <li> <a href="https://www.oracle.com/us/legal/terms/index.html" target="_blank">Terms of Use</a> </li>
                    <li> <a href="https://www.oracle.com/us/legal/privacy/index.html" target="_blank">Your Privacy Rights</a> </li>
                    <li> <a href="https://www.oracle.com/pls/topic/lookup?ctx=cpyr&id=en">Copyright © 2018, Oracle and/or its affiliates. All rights reserved.</a></li>
                </ul>
            </footer>
        </div>
        <script type="text/javascript" src="https://www.oracleimg.com/us/assets/metrics/ora_docs.js"></script>
    </div>
    <!-- OBE Dialog Box code 10/15/2018 -->
    <!-- DO NOT ALTER THE CODE BELOW   -->
    <div id="lpModal" class="modal">
        <!-- Modal hdr and body -->
        <div id="obe_dialog" class="modal-content">
            <div class="modal-header">
                <a href="#" class="close"> <span class="close">&times;</span> </a>
                <h1>Associated Learning Paths</h1>
            </div>
            <div id="dialog-content"> </div>
            <div id="dialog-close" class="closeBtn">
                <a href="#" class="close2">
                    <p class="close2"> <span>&nbsp;&nbsp;View&nbsp;&nbsp;</span> </p>
                </a>
            </div>
        </div>
    </div>
    <!-- END OBE Dialog Box code -->
</body>

</html>
